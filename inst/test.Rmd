```{r}
library(ghpm)
library(tidyverse)
library(purrr)
library(tibble)
```

```{r}
data <- graphql_query("issue_comments.graphql", org = "metrumresearchgroup", repo = "pkgr")$repository$issues$nodes

comments <- keep(data, ~length(.x$comments$nodes) > 0)

map_df(comments, function(x){
	writings <- reduce(x$comments$nodes, function(.acc, .cv){
		return(.acc %>% add_row("Comment" = .cv$bodyText, "Author" = .cv$author$login, "Date" = .cv$createdAt))
	}, .init = tibble("Comment" = character(), "Author" = character(), "Date" = character(), .rows = 0))
	
	return(writings %>% mutate("Issue" = x$number))
})
```

