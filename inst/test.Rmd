```{r}
library(ghpm)
library(tidyverse)
library(purrr)
```
```{r}
data <- graphql_query("issues.graphql", org = "metrumresearchgroup", repo = "pkgr")$repository$issues$nodes

issues <- reduce(data, function(.acc, .cv){
	.acc <- .acc %>% add_row("Title" = .cv$title, "Body" = .cv$bodyText, "Author" = .cv$author$login, "Number" = .cv$number, "Labels" = ifelse(!is_empty(.cv$labels$nodes), .cv$labels$nodes[[1]]$name, NA), "Milestone" = ifelse(is.null(.cv$milestone), "None", .cv$milestone), "State" = .cv$state)
	
	return(.acc)
}, .init = tibble("Title" = NA, "Body" = NA, "Author" = NA, "Number" = NA, "Labels" = NA, "Milestone" = NA, "State" = NA))

milestones = get_milestones("metrumresearchgroup", "pkgr")

# This doesn't work and I don't know how to fix it :( 
milestones <- milestones %>% rename(Milestone = Title)
left_join(milestones, issues, by = "Milestone")

```
